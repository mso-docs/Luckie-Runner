/* Speech bubble overlay */
.speech-bubble {
    position: absolute;
    left: 50%;
    bottom: 110px;
    transform: translate(-50%, 12px) scale(0.98);
    opacity: 0;
    pointer-events: none;
    max-width: 78%;
    z-index: 20;
    transition: opacity 0.25s ease, transform 0.25s ease;
    font-family: var(--font-main, 'Hey Gorgeous', 'Trebuchet MS', 'Fredoka One', 'Segoe UI', sans-serif) !important;
}

.speech-bubble.show {
    opacity: 1;
    transform: translate(-50%, 0) scale(1);
}

.speech-bubble__body,
.dialog-bubble {
    position: relative;
    background: radial-gradient(circle at 20% 30%, #ffffff 0%, #f7f7f7 55%, #ededed 100%);
    border: 3px solid #6b6b6b;
    border-radius: 32px;
    box-shadow: 0 10px 18px rgba(0, 0, 0, 0.35);
    padding: 18px 22px 20px;
    width: 460px;
    max-width: 90vw;
    color: #2b2b2b;
    font-family: var(--font-main, 'Hey Gorgeous', 'Trebuchet MS', 'Fredoka One', 'Segoe UI', sans-serif) !important;
    font-size: 20px;
    line-height: 1.25;
    letter-spacing: 0.3px;
    text-shadow: -1px -1px 0 #fff, 1px 1px 0 rgba(0, 0, 0, 0.1);
}

.sign-dialogue-bubble {
    --tail-offset: 20px;
    min-height: 72px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    justify-content: space-between;
}

.sign-dialogue-text {
    margin: 0;
    white-space: normal;
    word-break: break-word;
}

.sign-speech-bubble {
    position: absolute;
    pointer-events: none;
    z-index: 40;
    max-width: 78%;
}

.speech-bubble__body::before,
.dialog-bubble::before {
    content: '';
    position: absolute;
    left: calc(50% + var(--tail-offset, 0px));
    bottom: -26px;
    width: 0;
    height: 0;
    border: 18px solid transparent;
    border-top-color: #6b6b6b;
    border-left-color: #6b6b6b;
    transform: translateX(-50%) skewX(-8deg);
    filter: drop-shadow(0 4px 3px rgba(0, 0, 0, 0.2));
    z-index: -1;
}

.speech-bubble__body::after,
.dialog-bubble::after {
    content: '';
    position: absolute;
    left: calc(50% + var(--tail-offset, 0px));
    bottom: -22px;
    width: 0;
    height: 0;
    border: 16px solid transparent;
    border-top-color: #ededed;
    border-left-color: #ededed;
    transform: translateX(-50%) skewX(-8deg);
    filter: drop-shadow(0 4px 3px rgba(0, 0, 0, 0.15));
    z-index: -1;
}

.speech-bubble__hint {
    margin-top: 10px;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: #555;
    text-align: right;
    animation: speechHintPulse 1.4s ease-in-out infinite;
    font-family: var(--font-main, 'Hey Gorgeous', 'Trebuchet MS', 'Fredoka One', 'Segoe UI', sans-serif) !important;
}

@keyframes speechHintPulse {
    0% { opacity: 0.35; transform: translateY(0); }
    50% { opacity: 1; transform: translateY(-1px); }
    100% { opacity: 0.35; transform: translateY(0); }
}

/* Speech text inline effects */
#speechText {
    display: block;
    font-family: var(--font-main, 'Hey Gorgeous', 'Trebuchet MS', 'Fredoka One', 'Segoe UI', sans-serif) !important;
}

.speech-bold { font-weight: 800; }
.speech-italic { font-style: italic; }
.speech-mono { font-family: var(--font-main, 'Hey Gorgeous', 'Trebuchet MS', 'Fredoka One', 'Segoe UI', sans-serif) !important; background: rgba(0,0,0,0.05); padding: 0 2px; border-radius: 2px; }

.speech-big { font-size: 24px; }
.speech-bigger { font-size: 28px; }
.speech-gigantic { font-size: 32px; line-height: 1.1; }
.speech-tiny { font-size: 14px; }

.speech-glow {
    color: #c5ff4a;
    -webkit-text-stroke: 0.5px #0f3a0f;
    text-shadow:
        0 0 6px rgba(197,255,74,0.8),
        0 0 12px rgba(40,120,40,0.8),
        0 0 18px rgba(40,120,40,0.6);
    animation: speechGlowPulse 1.4s ease-in-out infinite;
}
.speech-bounce { display: inline-block; animation: speechBounce 0.8s ease-in-out infinite; }
.speech-shake { display: inline-block; animation: speechShake 0.18s ease-in-out infinite; }
.speech-rainbow {
    display: inline-block;
    animation: speechRainbow 1.8s linear infinite, speechRainbowGlow 1.8s linear infinite;
    -webkit-text-stroke: 0.5px #000;
    text-shadow:
        0 0 6px rgba(0,0,0,0.5),
        0 0 10px rgba(0,0,0,0.4);
}
.speech-wave-letter {
    display: inline-block;
    animation: speechWave 1.1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes speechBounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-2px); }
}

@keyframes speechShake {
    0%, 100% { transform: translate(0,0); }
    25% { transform: translate(-1px, 0); }
    50% { transform: translate(1px, 0); }
    75% { transform: translate(-1px, 0); }
}

@keyframes speechRainbow {
    0% { color: #ff6b6b; }
    25% { color: #ffd166; }
    50% { color: #6fffd9; }
    75% { color: #6b9bff; }
    100% { color: #ff6bff; }
}

@keyframes speechWave {
    0% { transform: translateY(0); }
    25% { transform: translateY(-3px); }
    50% { transform: translateY(0); }
    75% { transform: translateY(3px); }
    100% { transform: translateY(0); }
}

@keyframes speechRainbowGlow {
    0% { text-shadow: 0 0 8px rgba(255,107,107,0.7); }
    25% { text-shadow: 0 0 8px rgba(255,209,102,0.7); }
    50% { text-shadow: 0 0 8px rgba(111,255,217,0.7); }
    75% { text-shadow: 0 0 8px rgba(107,155,255,0.7); }
    100% { text-shadow: 0 0 8px rgba(255,107,255,0.7); }
}

@keyframes speechGlowPulse {
    0% { filter: brightness(1); text-shadow: 0 0 6px rgba(197,255,74,0.8), 0 0 12px rgba(40,120,40,0.8), 0 0 18px rgba(40,120,40,0.6); }
    50% { filter: brightness(1.25); text-shadow: 0 0 10px rgba(197,255,74,1), 0 0 18px rgba(40,120,40,0.95), 0 0 26px rgba(40,120,40,0.8); }
    100% { filter: brightness(1); text-shadow: 0 0 6px rgba(197,255,74,0.8), 0 0 12px rgba(40,120,40,0.8), 0 0 18px rgba(40,120,40,0.6); }
}
